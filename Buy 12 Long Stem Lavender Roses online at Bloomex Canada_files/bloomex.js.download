function setTestimonials(){jQuery('.testimonial').hide();var testimonials=jQuery('.testimonial').toArray();var elemlength=testimonials.length;var randomnum1=Math.floor(Math.random()*elemlength);var randomnum2=Math.floor(Math.random()*elemlength);var randomitem1=testimonials[randomnum1];var randomitem2=testimonials[randomnum2];jQuery(randomitem1).fadeIn('slow');jQuery(randomitem2).fadeIn('slow');return true;}
function submitorder(gcapcha){startLoader();console.log(gcapcha);jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=SetOrder',data:{gcapcha:gcapcha,customer_occasion:jQuery('#customer_occasion').val(),card_msg:jQuery('#card_msg').val(),signature:jQuery('#signature').val(),card_comment:jQuery('#card_comment').val(),find_us:jQuery('#find_us').val(),redeem_bucks:jQuery('#redeem_bucks').is(':checked')?1:0,redeem_credits:jQuery('#redeem_credits').is(':checked')?1:0,donation_id:jQuery('#donation_id').is(':checked')?jQuery('#donation_id').val():0,name_on_card:jQuery('#name_on_card').val(),card_number:jQuery('#card_number').val(),card_cvv:jQuery('#card_cvv').val(),expire_month:jQuery('#expire_month').val(),expire_year:jQuery('#expire_year').val()},dataType:'json',success:function(json){if(json.result){stopLoader();window.location.href='/'+lg.checkout_thankyou;}else{stopLoader();jQuery('div.checkout_buttons_wrapper div.result').text(json.error).css('display','inline-block');jQuery('div.checkout_processing').hide();jQuery('div.checkout_buttons').show();stopLoader();}},error:function(qXHR,textStatus,errorThrown){console.log(qXHR,textStatus,errorThrown);jQuery('div.checkout_buttons_wrapper div.result').text('There was an connection error running request, please try again').css('display','inline-block');stopLoader();}});}
if(!String.prototype.printf){String.prototype.printf=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};}
function setBannerTop(){jQuery('.banner_top_1, .banner_top_2, .orders_count').toggle();}
function startLoader(){jQuery('#ajaxloader').show();}
function stopLoader(){jQuery('#ajaxloader').hide();}
window.fbAsyncInit=function(){FB.init({appId:'159445328256306',cookie:true,xfbml:true,version:'v3.0'});FB.AppEvents.logPageView();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="https://connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));function checkFB(){startLoader();FB.getLoginStatus(function(response){statusChangeCallback(response);});}
function statusChangeCallback(response){if(response.status!=='connected'){FB.login(function(response){if(response.authResponse){fb_auth(response);}},{scope:'public_profile,email'});}else if(response.status==='connected'){fb_auth(response);}}
function checkLoginState(response){}
function fb_auth(response){FB.api('/me',function(response){jQuery.ajax({type:'POST',dataType:'json',url:'/index.php?option=com_new_social_login&social=Facebook&task=auth',data:({response:response}),success:function(json){if(json.result){document.location.reload(true);}else{alert('Error.');}
stopLoader();}});});}
function checkTW(){startLoader();jQuery.ajax({type:'POST',dataType:'json',url:'/index.php?option=com_new_social_login&social=Twitter&task=get_token',success:function(json){if(json.result){location.href='https://api.twitter.com/oauth/authenticate?oauth_token='+json.oauth_token;}else{alert('Error.');}
stopLoader();}});}
function AuthGP(GoogleAuth){var googleUser=GoogleAuth.currentUser.get();var profile=googleUser.getBasicProfile();var social_user_id=profile.getId();jQuery.ajax({type:'POST',dataType:'json',url:'/index.php?option=com_new_social_login&social=GooglePlus&task=auth',data:{social_user_id:social_user_id},success:function(json){if(json.result){document.location.reload(true);}else{alert('Error.');}
stopLoader();}});}
function checkGP(){startLoader();gapi.load('auth2',function(){var GoogleAuth=gapi.auth2.init({client_id:'786108318191-940kdtutuutejoiv6uh4ce4dnf0mrk5v.apps.googleusercontent.com'});if(GoogleAuth.isSignedIn.get()==true){AuthGP(GoogleAuth);}else{GoogleAuth.signIn({}).then(function(value){AuthGP(GoogleAuth);},function(reason){alert(reason.error);stopLoader();});}});}
function checkRegistrationForm(event){event.preventDefault();jQuery.each(required_fields,function(key,value){var field=jQuery('#'+value);if(field.val()==''){field.closest('div.form-group').addClass('has-error');field.focus();return false;}
if(key==required_fields.length-1){s=document.getElementById("SubmitReg")
s.click();return true;}});}
function checkUpdateBillingInfoForm(event){event.preventDefault();startLoader();jQuery.each(billing_info_required_fields,function(key,value){var field=jQuery('#billing_info_'+value);if(field.val()==''){field.closest('div.form-group').addClass('has-error');field.focus();stopLoader();return false;}
if(key==billing_info_required_fields.length-1){var form=jQuery('#update_billing_info_form')[0];var formData=new FormData(form);jQuery.ajax({url:'/',data:formData,type:'post',contentType:false,processData:false,dataType:'json',success:function(json){if(json.result){jQuery('.billing_row .billing_company').text(json.user_info_obj.company);jQuery('.billing_row .billing_full_name').text(json.user_info_obj.full_name);jQuery('.billing_row .billing_address').text(json.user_info_obj.address);jQuery('.billing_row .billing_phone_1').text(json.user_info_obj.phone_1);jQuery('.billing_row .billing_fax').text(json.user_info_obj.fax);jQuery('.billing_row .billing_user_email').text(json.user_info_obj.user_email);jQuery('div.update_billing_info_wrapper div.close_form').trigger('click');stopLoader();}else{alert(json.error);stopLoader();}}});}});}
function checkUpdateShippingInfoForm(event){event.preventDefault();jQuery('div.form-group').removeClass('has-error');startLoader();jQuery.each(shipping_info_required_fields,function(key,value){var field=jQuery('#shipping_info_'+value);if(field.val()==''||!field.val()){field.closest('div.form-group').addClass('has-error');field.focus();stopLoader();return false;}
if(key==shipping_info_required_fields.length-1){var form=jQuery('#update_shipping_info_form')[0];var formData=new FormData(form);formData.append('option','com_ajaxorder');formData.append('task','UpdateAddress');formData.append('address_type','ST');jQuery.ajax({url:'/',data:formData,type:'post',contentType:false,processData:false,dataType:'json',success:function(json){if(json.result){jQuery.ajax({type:'post',url:'/index.php?option=com_virtuemart&func=getSTAddresses',dataType:'json',success:function(json){if(json.result){var shipping_addresses='';jQuery.each(json.shipping_addresses,function(key,value){console.log(value);shipping_addresses+=value;});jQuery('table.shipping_addresses').html(shipping_addresses);jQuery('div.update_shipping_info_wrapper div.close_form').trigger('click');startLoader();jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=getDonationData',dataType:'json',success:function(json){if(json.result){jQuery('#donation_label').html(json.donate.label);jQuery('#donation_label').attr('title',json.donate.text);jQuery('#donation_id').val(json.donate.id);jQuery('label.container.donation').show();setTimeout(jQuery('html, body').animate({scrollTop:jQuery('.delivery_wrapper').offset().top-65},500,stopLoader()),800);}else{stopLoader();}}});}}});}else{alert(json.error);stopLoader();}}});}});if(jQuery('#delivery_date_2').val()!=''){jQuery('#delivery_date_2').val('');jQuery('.ddate_tooltip').show();setTimeout(function(){jQuery('.ddate_tooltip').hide('slow');},4000);}}
function setCart(json){var products_html='';jQuery.each(json.products,function(key,value){products_html+='<div class="product">';products_html+='<div class="image">';products_html+='<img src="'+value.image+'" />';products_html+='</div>';products_html+='<div class="info">';products_html+='<div class="name">';products_html+=value.name;products_html+='</div>';products_html+='<div class="price">';products_html+=value.quantity+' x <span>$'+value.price+'</span>';products_html+='</div>';products_html+='</div>';products_html+='</div>';products_html+='<hr/>';});jQuery('div.hover_cart_wrapper .hover_cart_inner .products').html(products_html);jQuery('div.hover_cart_wrapper .hover_cart_inner .total span').html('$'+json.cart_price);jQuery('div.top_cart div.title div.info').text(json.cart_items+' Items - $'+json.cart_price);jQuery('tr.subtotal span.cart_subtotal').text('$'+json.cart_price);jQuery('tr.subtotal span.corporate_discount').text('$'+json.corporate_discount);jQuery('tr.subtotal span.cart_total').text('$'+json.cart_total);if(json.coupon_discount>0){$('.basket_coupon').show();$('.basket_coupon .basket_coupon_discount').html("$"+json.coupon_discount)}else{$('.basket_coupon').hide();}}
function loadCart(){jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=CartAction',data:({action:'GetCart'}),dataType:'json',success:function(json){setCart(json);}});}
loadCart();jQuery('.extra_products').slick({dots:false,infinite:true,speed:300,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:true,dots:true}},{breakpoint:991,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:767,settings:{slidesToShow:2,slidesToScroll:1}}]});var subcategory_previews=jQuery('img.subcategory_image_real');jQuery.each(subcategory_previews,function(key,value){if(value.complete){jQuery(this).parent().find('.subcategory_image_loader').hide();jQuery(this).show();}else{jQuery(this).on('load',function(){jQuery(this).parent().find('.subcategory_image_loader').hide();jQuery(this).show();});jQuery(this).on('error',function(){});}});var previews=jQuery('img.product_image_real');jQuery.each(previews,function(key,value){if(value.complete){jQuery(this).parent().find('.product_image_loader').hide();jQuery(this).show();}else{jQuery(this).on('load',function(){jQuery(this).parent().find('.product_image_loader').hide();jQuery(this).show();});jQuery(this).on('error',function(){});}});function b64EncodeUnicode(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function toSolidBytes(match,p1){return String.fromCharCode('0x'+p1);}));}
function initMap(){jQuery('#map').css({'display':'block','height':'265px','width':jQuery('.sale_banners').width()+'px','float':'right','position':'relative','top':'0px','max-width':'615px','max-height':'265px','margin-left':'auto','margin-right':'auto','left':'0','right':'0','background-size':'cover'});jQuery('.sale_banners').find('img').css('visibility','hidden');jQuery('#map').css('background-image','url('+landing_image+')');jQuery('#map').show();}
function GetOrdering(attr,ascdesc){jQuery.each(jQuery('.container.products .row'),function(key,value){var c=jQuery.makeArray(jQuery(this).children('div.wrapper'));if(attr=='rating_ordering'){c.sort(function(a,b){return Math.random()-0.5;});}else{c.sort(function(a,b){a=parseFloat(jQuery(a).attr(attr));b=parseFloat(jQuery(b).attr(attr));if(ascdesc=='desc'){return b-a;}
if(ascdesc=='asc'){return a-b;}});}
jQuery(c).appendTo(jQuery(this));});}
function getCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return "";}
jQuery(document).ready(function(){var phonesTemplate=[{"mask":"###-###-####"},{"mask":"###-###-####"}];$('#shipping_info_phone_1').inputmask({mask:phonesTemplate,greedy:false,definitions:{'#':{validator:"[0-9]",cardinality:1}}});$('.custom_accordion_header').click(function(){if($(this).find('.glyphicon').hasClass('glyphicon-circle-arrow-down')){$(this).find('.glyphicon').removeClass('glyphicon-circle-arrow-down').addClass('glyphicon-circle-arrow-right');$(this).next('.custom_accordion_text').slideUp('slow')}else{$('.custom_accordion_text').hide();$('.custom_accordion_header').find('.glyphicon').removeClass('glyphicon-circle-arrow-down').addClass('glyphicon-circle-arrow-right');$(this).find('.glyphicon').removeClass('glyphicon-circle-arrow-right').addClass('glyphicon-circle-arrow-down');$(this).next('.custom_accordion_text').slideDown('slow');}});var product_ordering=getCookie('product_ordering');switch(product_ordering){case 'desc':GetOrdering('price_ordering','desc');break;case 'asc':GetOrdering('price_ordering','asc');break;}
jQuery('body').on('click','.sort_by_select',function(event){if(jQuery('.sort_by_select').find('span').hasClass('glyphicon-sort-by-attributes-alt')){jQuery('.sort_by_select').find('span').removeClass('glyphicon-sort-by-attributes-alt').addClass('glyphicon-sort-by-attributes')
GetOrdering('price_ordering','asc');document.cookie='product_ordering=asc';}else if(jQuery('.sort_by_select').find('span').hasClass('glyphicon-sort-by-attributes')){jQuery('.sort_by_select').find('span').removeClass('glyphicon-sort-by-attributes').addClass('glyphicon-sort-by-attributes-alt')
GetOrdering('price_ordering','desc');document.cookie='product_ordering=desc';}else{jQuery('.sort_by_select').find('span').removeClass('glyphicon-sort-by-attributes-alt').addClass('glyphicon-sort-by-attributes')
GetOrdering('price_ordering','asc');document.cookie='product_ordering=asc';}});if(jQuery('.testimonials').is(':visible')){setTestimonials();setInterval(setTestimonials,10000);}
setBannerTop();setInterval(setBannerTop,5000);jQuery('.form-add-cart .add').click(function(event){if(!jQuery(this).hasClass('call_for_pricing')){event.preventDefault();startLoader();var product_id=parseInt(jQuery(this).attr('product_id'));var quantity=parseInt(jQuery('input[name="quantity_'+product_id+'"]').val());var select_bouquet=jQuery("[name='select_bouquet']").is(':checked')?jQuery("[name='select_bouquet']:checked").val():'standard';var select_sub=jQuery("[name='select_sub']").is(':checked')?jQuery("[name='select_sub']:checked").val():'';var extra_touches=jQuery('input[name="extra_products"]').is(':checked')?jQuery('input[name="extra_products"]:checked').serialize():0;jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=CartAction',data:({action:'AddToCart',product_id:product_id,quantity:quantity,select_bouquet:select_bouquet,select_sub:select_sub,extra_touches:extra_touches}),product_id:product_id,dataType:'json',success:function(json){setCart(json);pos=location.href.indexOf(lg.shopping_cart);if(pos!=-1){location.reload();}else{if(json.cart_items>0){jQuery.each(json.products,function(key,value){if(value.id==product_id&&value.select_bouquet==select_bouquet&&value.select_sub==select_sub){var last_product=value;var cart_modal_html='<div class="cart_modal_wrapper">';cart_modal_html+='<div class="cart_modal_inner">';cart_modal_html+='<div class="remove">';cart_modal_html+='</div>';cart_modal_html+='<div class="title">';cart_modal_html+='<img src="/templates/bloomex_adaptive/images/mark_cart.svg" alt="" />';cart_modal_html+=lg.product_sucessfully_added;cart_modal_html+='</div>';cart_modal_html+='<div class="product">';cart_modal_html+='<div class="product_image">';cart_modal_html+='<img src="'+last_product.image+'" alt="'+last_product.name+'" />';cart_modal_html+='</div>';cart_modal_html+='<div class="product_info">';cart_modal_html+='<div class="name">';cart_modal_html+=last_product.name;cart_modal_html+='</div>';cart_modal_html+='<div class="quantity">';cart_modal_html+='Quantity: '+last_product.quantity;cart_modal_html+='</div>';cart_modal_html+='<div class="total">';cart_modal_html+=lg.total+': <span>$'+(Math.floor(parseFloat(last_product.price*last_product.quantity)*1000)/1000).toFixed(2)+'</span>';cart_modal_html+='</div>';cart_modal_html+='</div>';cart_modal_html+='</div>';cart_modal_html+='<hr/>';cart_modal_html+='<div class="items">';cart_modal_html+=lg.there_are_x_items_in_your_cart.printf(json.cart_items);cart_modal_html+='</div>';cart_modal_html+='<div class="total">';cart_modal_html+='Total: <span>$'+json.cart_price+'</span>';cart_modal_html+='</div>';cart_modal_html+='<div class="buttons">';cart_modal_html+='<button type="submit" class="btn continue"><img src="/templates/bloomex_adaptive/images/next-cart.svg">'+lg.continue_shopping+'</button>';cart_modal_html+='<button type="submit" class="btn proceed">'+lg.proceed_to_checkout+'<img src="/templates/bloomex_adaptive/images/next-cart.svg"></button>';cart_modal_html+='</div>';cart_modal_html+='</div>';cart_modal_html+='</div>';jQuery('.page').append(cart_modal_html);var preview=jQuery('.cart_modal_wrapper .cart_modal_inner .product .product_image img');if(preview.complete){jQuery('.cart_modal_wrapper').show();stopLoader();}else{preview.on('load',function(){jQuery('.cart_modal_wrapper').show();stopLoader();});preview.on('error',function(){});}}});}}}});}});jQuery('.mobile_menu_toggle, .mobile_menu_wrapper, .mobile_menu ul.wrapper li div.remove').click(function(event){event.preventDefault();if(parseInt(jQuery('.mobile_menu').css('left'))==0){jQuery('body').css({'overflow-x':'hidden'});jQuery('.page').css({'left':'0px'});jQuery('.mobile_menu').css({'left':'-'+jQuery('.mobile_menu').css('width')});jQuery('.mobile_menu_wrapper').css('opacity','0').hide();jQuery('.page').css({'position':'relative','display':'block','overflow-y':'auto','height':'auto'});}else{jQuery('body').css({'overflow-x':'unset'});jQuery('.mobile_menu').css({'left':'0px'});jQuery('.page').css({'left':jQuery('.mobile_menu').css('width')});jQuery('.mobile_menu_wrapper').show().css('opacity','1');jQuery('.page').css({'position':'fixed','display':'table','overflow-y':'hidden','height':'100vh'});}});jQuery('.mobile_menu ul.wrapper li>span.plus, .mobile_menu ul.wrapper li>span.minus').click(function(event){event.preventDefault();if(jQuery(this).parent().find('.inner').is(':visible')){jQuery(this).hide();jQuery(this).parent().find('.plus').show();jQuery(this).parent().find('.inner').slideUp('slow');}else{jQuery(this).hide();jQuery(this).parent().find('.minus').show();jQuery(this).parent().find('.inner').slideDown('slow');}});jQuery('#mobile_search').click(function(event){event.preventDefault();if(jQuery('.mobile_search').is(':visible')){jQuery('.mobile_search').slideUp('slow');}else{jQuery('.mobile_search').slideDown('slow');}});jQuery('#md_search').click(function(event){event.preventDefault();if(jQuery('.md_search_wrapper').is(':visible')){jQuery('.md_search_wrapper').slideUp('slow');}else{jQuery('.md_search_wrapper').slideDown('slow');}});jQuery('#mobile_search_btn').click(function(event){event.preventDefault();jQuery('#mobile_search_form').submit();});jQuery('#search_btn').click(function(event){event.preventDefault();var input=document.getElementById("mainsearch");window.location=window.location.origin+'/'+lg.search+input.value+'/';});jQuery('#search_md_btn').click(function(event){event.preventDefault();jQuery('#search_md_form').submit();});jQuery('div.container.product_details_wrapper div.help').hover(function(){jQuery(this).children().show();},function(){jQuery(this).children().hide();});jQuery('div.container.product_details_wrapper div.sizes div.size').click(function(event){event.preventDefault();jQuery('#select_size').val(jQuery(this).attr('size'));jQuery('div.container.product_details_wrapper div.sizes div.size').removeClass('active');jQuery(this).addClass('active');});jQuery('table.table.cart tr td .quantity span').click(function(event){event.preventDefault();startLoader();var input=jQuery(this).closest('div').find('input');var old_val=parseInt(input.val());var new_val=1;var operation=jQuery(this).attr('class');var cart_product_id=parseInt(jQuery(this).closest('tr').attr('cart_product_id'));var cart_product_i=parseInt(jQuery(this).closest('tr').attr('i'));if(operation=='plus'){new_val=old_val+1;}else if(operation=='minus'){if(old_val>1){new_val=old_val-1;}}
input.val(new_val);jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=CartAction',data:({action:'SetQuantityCart',product_id:cart_product_id,product_i:cart_product_i,new_val:new_val}),dataType:'json',new_val:new_val,success:function(json){setCart(json);jQuery('tr[i="'+cart_product_i+'"]').find('td.cart_product_subtotal_'+cart_product_id).text('$'+json.new_subtotal_product);stopLoader();}});});jQuery('table.table.cart tr td .quantity input').change(function(){startLoader();var new_val=parseInt(jQuery(this).val());var cart_product_id=parseInt(jQuery(this).closest('tr').attr('cart_product_id'));var cart_product_i=parseInt(jQuery(this).closest('tr').attr('i'));if(isNaN(new_val)||new_val<1){new_val=1;}
jQuery(this).val(new_val);jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=CartAction',data:({action:'SetQuantityCart',product_id:cart_product_id,product_i:cart_product_i,new_val:new_val}),dataType:'json',success:function(json){setCart(json);jQuery('tr[i="'+cart_product_i+'"]').find('td.cart_product_subtotal_'+cart_product_id+'-'+cart_product_i).text('$'+json.new_subtotal_product);stopLoader();}});});jQuery('tr.cart_product_tr div.remove').click(function(event){event.preventDefault();startLoader();var cart_product_id=parseInt(jQuery(this).closest('tr').attr('cart_product_id'));var cart_product_i=parseInt(jQuery(this).closest('tr').attr('i'));jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=CartAction',data:({action:'RemoveFromCart',product_id:cart_product_id,product_i:cart_product_i}),dataType:'json',cart_product_id:cart_product_id,success:function(json){setCart(json);if(json.cart_items==0){document.location.href="/";return true;}else{jQuery('tr[i="'+cart_product_i+'"]').remove();jQuery.each(jQuery('tr.cart_product_tr'),function(index){jQuery(this).attr('i',index);});stopLoader();}}});});jQuery('div.coupon_field div.hide_field a').click(function(event){event.preventDefault();startLoader();jQuery('div.coupon_field div.hide_field').slideUp('slow');jQuery('div.coupon_field div.show_field').slideDown('slow');stopLoader();});jQuery('div.billing_wrapper div.billing_info_wrapper button').click(function(event){event.preventDefault();startLoader();jQuery('.billing_info_wrapper').css('visibility','hidden').slideUp('slow');jQuery('.update_billing_info_wrapper').slideDown('slow');stopLoader();});jQuery('div.update_billing_info_wrapper div.close_form').click(function(event){event.preventDefault();startLoader();jQuery('.billing_info_wrapper').css('visibility','visible').slideDown('slow');jQuery('.update_billing_info_wrapper').slideUp('slow');stopLoader();});jQuery('div.shipping_wrapper div.shipping_info_wrapper button.add_shipping_address').click(function(event){event.preventDefault();startLoader();jQuery('div.form-group').removeClass('has-error');jQuery.each(jQuery('form#update_shipping_info_form input'),function(){if(this.id!='shipping_info_country'){jQuery(this).val('');}});jQuery.each(jQuery('form#update_shipping_info_form select'),function(){var id=jQuery(this).attr('id');});jQuery('#shipping_info_address_type2').val('Home/Residence');jQuery('.shipping_info_wrapper').hide();jQuery('.update_shipping_info_wrapper').show();jQuery('html, body').animate({scrollTop:jQuery('.shipping_wrapper').offset().top},500,stopLoader());});jQuery('div.update_shipping_info_wrapper div.close_form').click(function(event){event.preventDefault();startLoader();jQuery('.shipping_info_wrapper').css('visibility','visible').slideDown('slow');jQuery('.update_shipping_info_wrapper').slideUp('slow');stopLoader();});jQuery('body').on('click','button.edit_shipping_address',function(event){event.preventDefault();startLoader();jQuery('div.form-group').removeClass('has-error');var user_info_id=jQuery(this).closest('tr').attr('user_info_id');jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=getUserAddress',data:({user_info_id:user_info_id}),dataType:'json',user_info_id:user_info_id,success:function(json){if(json.result){jQuery.each(json.shipping_obj,function(key,value){if(key=='address_type2'){if(value=='B'){value='Business'}
if(value=='R'||value==''){value='Home/Residence'}
jQuery(".div_shipping_info_company").show()
if(value=='Home/Residence'||value=='Business'){if(value=='Business'){jQuery("#googleaddressupdate_shipping").attr('placeholder','start typing Business name...')}else{jQuery("#googleaddressupdate_shipping").attr('placeholder','start typing address...')}
jQuery('.autocomplete_address').show()
jQuery('.autocomplete_place').hide()}else{jQuery("#googleaddressupdate_place").attr('placeholder','start typing City or name of '+value+'...')
jQuery('.autocomplete_address').hide()
jQuery('.autocomplete_place').show()}
jQuery('#place_result').html('').hide()}
jQuery('#shipping_info_'+key).val(value);});jQuery('.shipping_info_wrapper').css('visibility','hidden').slideUp('slow');jQuery('.update_shipping_info_wrapper').slideDown('slow');}else{alert('Error.');}
stopLoader();}});});jQuery('body').on('click','.sameAsBillingBtn',function(event){event.preventDefault();startLoader();jQuery('div.form-group').removeClass('has-error');jQuery.ajax({type:'POST',url:'/index.php?option=com_ajaxorder&task=copyUserBillingAddress',dataType:'json',success:function(json){if(json.result){jQuery.each(json.billingObj,function(key,value){if(key=='address_type2'){if(value=='B'){value='Business'}
if(value=='R'||value==''){value='Home/Residence'}
jQuery(".div_shipping_info_company").show()
if(value=='Home/Residence'||value=='Business'){if(value=='Business'){jQuery("#googleaddressupdate_shipping").attr('placeholder','start typing Business name...')}else{jQuery("#googleaddressupdate_shipping").attr('placeholder','start typing address...')}
jQuery('.autocomplete_address').show()
jQuery('.autocomplete_place').hide()}else{jQuery("#googleaddressupdate_place").attr('placeholder','start typing City or name of '+value+'...')
jQuery('.autocomplete_address').hide()
jQuery('.autocomplete_place').show()}
jQuery('#place_result').html('').hide()}
jQuery('#shipping_info_'+key).val(value);});jQuery('.shipping_info_wrapper').css('visibility','hidden').slideUp('slow');jQuery('.update_shipping_info_wrapper').slideDown('slow');}else{alert('Error.');}
stopLoader();}});});jQuery('body').on('click','button.remove_shipping_address',function(event){event.preventDefault();startLoader();var user_info_id=jQuery(this).closest('tr').attr('user_info_id');jQuery.ajax({type:'POST',url:'index.php?',data:({option:'com_ajaxorder',task:'RemoveAddress',user_info_id:user_info_id}),dataType:'json',user_info_id:user_info_id,success:function(json){if(json.result){jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=getSTAddresses',dataType:'json',success:function(json){if(json.result){var shipping_addresses='';jQuery.each(json.shipping_addresses,function(key,value){console.log(value);shipping_addresses+=value;});jQuery('table.shipping_addresses').html(shipping_addresses);jQuery('div.update_shipping_info_wrapper div.close_form').trigger('click');jQuery.ajax({type:'POST',url:'index.php?option=com_virtuemart&func=getDonationData',dataType:'json',success:function(json){if(json.result){jQuery('#donation_label').html(json.donate.label);jQuery('#donation_label').attr('title',json.donate.text);jQuery('#donation_id').val(json.donate.id);jQuery('label.container.donation').show();}}});}else{jQuery('table.shipping_addresses').html('');}
stopLoader();}});}else{alert('Error.');stopLoader();}}});});jQuery('div.delivery_date_wrapper button').click(function(event){event.preventDefault();startLoader();jQuery.ajax({type:'POST',url:'index.php?option=com_virtuemart&func=getDeliveryCalendarOptions',data:{delivery_date:jQuery('#delivery_date_2').val()},dataType:'json',success:function(json){if(json.result){jQuery('div.calendar_wrapper .calendar').html(json.calendar);jQuery('div.calendar_wrapper .delivery').html(json.options);jQuery('div.delivery_date_wrapper').css('visibility','hidden').slideUp('slow');jQuery('div.calendar_wrapper').slideDown('slow');stopLoader();if(json.error){alert(json.error)}}}});});jQuery('div.calendar_wrapper div.close_form').click(function(event){event.preventDefault();startLoader();jQuery('div.delivery_date_wrapper').css('visibility','visible').slideDown('slow');jQuery('div.calendar_wrapper').slideUp('slow');stopLoader();});jQuery('body').on('click','.delivery_calendar .next_month, .delivery_calendar .pre_month',function(event){event.preventDefault();startLoader();jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=getDeliveryCalendarHTML',data:{delivery_date:jQuery(this).attr('delivery_date')},dataType:'json',success:function(json){if(json.result){jQuery('div.calendar_wrapper .calendar').html(json.calendar);stopLoader();}}});});jQuery('body').on({mouseenter:function(){jQuery('#delivery_date').text(jQuery(this).attr('delivery_beaty_date')).show();},mouseleave:function(){jQuery('#delivery_date').hide();}},'.delivery_calendar .day_inner.ready, .delivery_calendar .day_inner.now');jQuery('body').on('click touchstart','.delivery_calendar .day_inner.ready, .delivery_calendar .day_inner.now',function(event){event.preventDefault();startLoader();jQuery('#delivery_date_2').val(jQuery(this).attr('delivery_date'));jQuery('div.delivery_date_wrapper').css('visibility','visible').slideDown('slow');jQuery('div.calendar_wrapper').slideUp('slow',function(){jQuery('html, body').animate({scrollTop:jQuery('#card_msg_title').offset().top},1000,stopLoader());});});jQuery('body').on('change','input[type=radio][name=delivery_option_id]',function(){startLoader();jQuery.ajax({type:'POST',url:'index.php?option=com_virtuemart&func=getDeliveryCalendarHTML',data:{delivery_date:jQuery('#delivery_date_2').val(),delivery_option_id:jQuery(this).val()},dataType:'json',success:function(json){if(json.result){jQuery('div.calendar_wrapper .calendar').html(json.calendar);stopLoader();}}});});jQuery('body').on('change','input[type=radio][name=user_info_id]',function(){startLoader();jQuery('div.delivery_date_wrapper').css('visibility','visible').slideDown('slow');jQuery('div.calendar_wrapper').slideUp('slow');jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=setDeliveryAddress',data:{user_info_id:jQuery(this).val()},dataType:'json',success:function(json){if(json.result){jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=getDonationData',dataType:'json',success:function(json){if(json.result){jQuery('#donation_label').html(json.donate.label);jQuery('#donation_label').attr('title',json.donate.text);jQuery('#donation_id').val(json.donate.id);jQuery('label.container.donation').show();if(jQuery('#delivery_date_2').val()!=''){jQuery('#delivery_date_2').val('');jQuery('.ddate_tooltip').show();setTimeout(function(){jQuery('.ddate_tooltip').hide('slow');},4000);}}
stopLoader();}});}}});});jQuery('body').on('input keydown','#card_number',function(){var first=parseInt(jQuery(this).val()[0]);jQuery('.payment_method').removeClass('active').addClass('unactive');if(first==4){jQuery('.visa').removeClass('unactive').addClass('active');}else if(first==5||first==6){jQuery('.mastercard').removeClass('unactive').addClass('active');}else if(first==3){jQuery('.american_express').removeClass('unactive').addClass('active');}});jQuery('div.coupon_field button').click(function(event){event.preventDefault();jQuery('div.coupon_field div.result').hide().removeClass('success');startLoader();jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=SetCouponCode',data:{coupon_code:jQuery('#coupon_code').val()},dataType:'json',success:function(json){if(json.result){jQuery('div.coupon_field div.result').text(json.info).addClass('success').css('display','inline-block');if(typeof url_coupon_code!=='undefined'&&url_coupon_code!=false){jQuery('div.coupon_field .coupon_text_desc').hide();jQuery('div.coupon_field #coupon_btn').hide();loadCart();}}else{jQuery('div.coupon_field div.result').text(json.error).css('display','inline-block');}
stopLoader();}});});if(typeof url_coupon_code!=='undefined'&&url_coupon_code!=false){jQuery('div.coupon_field button').trigger('click');}
jQuery('div.checkout_buttons_wrapper button#calculate').click(function(event){event.preventDefault();jQuery('div.checkout_buttons_wrapper div.result').hide();startLoader();jQuery.ajax({type:'POST',url:'index.php?option=com_virtuemart&func=GetTotalAjax',data:{delivery_date:jQuery('#delivery_date_2').val(),redeem_bucks:jQuery('#redeem_bucks').is(':checked')?1:0,donation_id:jQuery('#donation_id').is(':checked')?jQuery('#donation_id').val():0,redeem_credits:jQuery('#redeem_credits').is(':checked')?1:0},dataType:'json',success:function(json){if(json.result){jQuery('div.price_inner div.total_item_price span.price').text('$'+json.products_price);jQuery('div.price_inner div.corporate_discount span.price').text('-$'+json.corporate_discount);jQuery('div.price_inner div.coupon_discount span.price').text('-$'+json.coupon_discount);jQuery('div.price_inner div.total_taxes span.price').text('$'+json.taxes_price);jQuery('div.price_inner div.total_bloomex_bucks span.price').text('-$'+json.used_bucks);jQuery('div.price_inner div.total_credits span.price').text('-$'+json.used_credits);jQuery('div.price_inner div.total_donate span.price').text('$'+json.donated_price);jQuery('div.price_inner div.total_delivery_price span.price').text('$'+json.shipping_price);jQuery('div.price_inner div.total_discount span.price').text('-$'+json.coupon_discount);jQuery('div.price_inner div.total_price span.price').text('$'+(parseFloat(json.total_price)+parseFloat(json.donated_price)));}else{jQuery('div.checkout_buttons_wrapper div.result').text(json.error[0]).css('display','inline-block');}
stopLoader();},error:function(qXHR,textStatus,errorThrown){console.log(qXHR,textStatus,errorThrown);jQuery('div.checkout_buttons_wrapper div.result').text('There was an connection error running request, please try again').css('display','inline-block');stopLoader();}});});jQuery('div.checkout_buttons_wrapper button#confirm').click(function(event){event.preventDefault();if(jQuery('.update_shipping_info_wrapper').is(':visible')==true){if(client_lang=='en'){shipping_info_text='"New Delivery Address" as input not Saved - please Save or Close(X) to process order.';}else{shipping_info_text='"Nouvelle adresse de livraison" entrée non enregistrer - veuillez enregistrer ou fermer(X) pour traiter la commande.';}
jQuery('div.checkout_buttons_wrapper div.result').text(shipping_info_text).css('display','inline-block');jQuery('.update_shipping_info_wrapper .btn').after('<span class="result">Please save address first</span>');jQuery('html, body').animate({scrollTop:jQuery('.update_shipping_info_wrapper .btn').offset().top-100},1000,stopLoader());return false;}
jQuery('div.checkout_buttons').hide();jQuery('div.checkout_buttons_wrapper div.result').hide();jQuery('div.checkout_processing').show();startLoader();jQuery.ajax({type:'POST',url:'/index.php?option=com_virtuemart&func=GetTotalAjax',data:{delivery_date:jQuery('#delivery_date_2').val(),redeem_bucks:jQuery('#redeem_bucks').is(':checked')?1:0,donation_id:jQuery('#donation_id').is(':checked')?jQuery('#donation_id').val():0,redeem_credits:jQuery('#redeem_credits').is(':checked')?1:0},dataType:'json',success:function(json){if(json.result){jQuery('div.price_inner div.total_item_price span.price').text('$'+json.products_price);jQuery('div.price_inner div.total_delivery_price span.price').text('$'+json.shipping_price);jQuery('div.price_inner div.total_discount span.price').text('$'+json.coupon_discount);jQuery('div.price_inner div.total_price span.price').text('$'+(parseFloat(json.total_price)+parseFloat(json.donated_price)));grecaptcha.reset();grecaptcha.execute();stopLoader();}else{jQuery('div.checkout_buttons_wrapper div.result').text(json.error[0]).css('display','inline-block');jQuery('div.checkout_processing').hide();jQuery('div.checkout_buttons').show();stopLoader();}}});});jQuery('body').on('click','div.cart_modal_wrapper',function(event){event.preventDefault();var inner=jQuery('div.cart_modal_inner');if(!inner.is(event.target)&&inner.has(event.target).length===0){jQuery(this).find('div.remove').trigger('click');}});jQuery('body').on('click','div.cart_modal_wrapper div.remove',function(event){event.preventDefault();jQuery(this).closest('div.cart_modal_wrapper').remove();});jQuery('body').on('click','div.cart_modal_wrapper div.cart_modal_inner div.buttons button.continue',function(event){event.preventDefault();jQuery('div.cart_modal_wrapper div.cart_modal_inner div.remove').trigger('click');});jQuery('body').on('click','div.cart_modal_wrapper div.cart_modal_inner div.buttons button.proceed',function(event){event.preventDefault();window.location.href='/'+lg.shopping_cart;});jQuery('body').on('click','div.hover_cart_wrapper div.hover_cart_inner div.buttons button',function(event){event.preventDefault();startLoader();window.location.href='/'+lg.shopping_cart;});jQuery('#lostpass_button').click(function(event){event.preventDefault();jQuery('#lostpass_info').hide();jQuery('#lostpass_error').hide();jQuery('#lostpass_success').hide();jQuery('#lostpass_table').hide();jQuery('#lostpass_loader').show();jQuery.ajax({type:'POST',url:'/',async:true,dataType:'json',data:({option:'com_registration',task:'sendNewPass',confirmEmail:jQuery('#confirmEmail').val()}),success:function(data){jQuery('#lostpass_loader').hide();if(data.result){jQuery('#lostpass_success').html(data.msg).show();jQuery('#lostpass_info').show();}else{jQuery('#lostpass_error').html(data.msg).show();jQuery('#lostpass_info').show();}}});});jQuery('#lostpass_button_new').click(function(event){event.preventDefault();jQuery('#lostpass_info').hide();jQuery('#lostpass_error').hide();jQuery('#lostpass_success').hide();jQuery('#lostpass_table').hide();jQuery('#lostpass_loader').show();jQuery.ajax({type:"POST",url:"/",async:true,dataType:'json',data:({option:'com_registration',task:'createPass',createnew:'1',hash:jQuery('#user_hash').val(),new_password:jQuery('#new_password').val(),new_password_2:jQuery('#new_password_2').val()}),success:function(data){jQuery('#lostpass_loader').hide();if(data.result){jQuery('#lostpass_success').html(data.msg).show();jQuery('#lostpass_info').show();}else{jQuery('#lostpass_error').html(data.msg).show();jQuery('#lostpass_info').show();}}});});jQuery('span.landing_content_more_btn').click(function(event){event.preventDefault();jQuery(this).hide();jQuery('span.landing_content_more').show();});if((typeof(landing_image)!='undefined'&&landing_image!==null)){initMap();}
jQuery('span.city_load_more').click(function(event){event.preventDefault();jQuery(this).hide();jQuery('.hidden_cities').show();});jQuery(window).scroll(function(){if(jQuery(this).scrollTop()>0){jQuery('.container-fluid.top_3').css('position','fixed');}else{jQuery('.container-fluid.top_3').css('position','relative');}});function setInputFilter(textbox,inputFilter){["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop"].forEach(function(event){textbox.addEventListener(event,function(){if(inputFilter(this.value)){this.oldValue=this.value;this.oldSelectionStart=this.selectionStart;this.oldSelectionEnd=this.selectionEnd;}else if(this.hasOwnProperty("oldValue")){this.value=this.oldValue;this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd);}});});}
jQuery('.tooltripHoverBox').mouseover(function(){if(!jQuery('.tooltripDiv').hasClass('hideTooltrip')){jQuery(this).find('.tooltripDiv').show()}else{jQuery(this).find('.tooltripDiv').hide()}});jQuery('.tooltripHoverBox').mouseout(function(){jQuery(this).find('.tooltripDiv').hide()});jQuery('.closeTooltrip').click(function(){jQuery('.tooltripDiv').addClass('hideTooltrip').hide();})
jQuery('.bouquet_info_icon').click(function(event){event.preventDefault();var info_bouguet='';jQuery('.product_size_type_tooltrip').each(function(index,elem){var e=jQuery(elem).clone()
jQuery('span',e).remove()
info_bouguet+=e.html()+"<br>"
if(index==0){info_bouguet+="<hr style='width: 50%'><br>"}})
jQuery('.bouquet_info').html('<span class="close_tooltrip_popup">X</span>'+info_bouguet).show()});jQuery('.bouquet_info').click(function(){jQuery(this).hide()});jQuery('.mobile_popup > .inner > .close_btn').click(function(event){event.preventDefault();jQuery('.mobile_popup').animate({top:-136},500);});jQuery('#registration_form #email').change(function(e){jQuery(this).closest('form').find('button').prop('disabled',true);jQuery(this).parent().removeClass('has-success has-error');jQuery(this).next('.error').hide();jQuery(this).addClass('loading');jQuery.ajax({type:"POST",url:"/index.php",async:true,dataType:'json',data:({option:'com_registration',task:'checkEmail',email:jQuery(this).val()}),context:this,success:function(data){if(data.result){jQuery(this).removeClass('loading');jQuery(this).closest('form').find('button').prop('disabled',false);}else{jQuery(this).removeClass('loading');jQuery(this).parent().addClass('has-error');jQuery(this).next('.error').css('display','block');}}});});jQuery('.description-footer > .row .toggle').click(function(e){e.preventDefault();var description_footer=jQuery(this).closest('.description-footer');if(description_footer.hasClass('opened')){description_footer.removeClass('opened');}else{description_footer.addClass('opened');}});$('input[name="extra_products"]').change(function(){if($(this).prop('checked')){$(this).parents('.extraProductBox').css({'border-color':'#A40001'})}else{$(this).parents('.extraProductBox').css({'border-color':'#eee'})}});});if((document.cookie.replace(/(?:(?:^|.*;\s*)MobileSaveBannerShown\s*\=\s*([^;]*).*$)|^.*$/,"$1")!=="true")&&(!((window.location.href.indexOf("panier")>-1)||(window.location.href.indexOf("checkout")>-1)||(window.location.href.indexOf("Checkout")>-1)||(window.location.href.indexOf("cart")>-1)||(window.location.href.indexOf("order")>-1)))){var date=new Date;document.cookie="MobileSaveBannerShown=true; expires="+date.toGMTString(date.setDate(date.getDate()+7));jQuery(window).on('load',function(){var windowWidth=jQuery(window).width();console.log("trying pop");console.log(windowWidth);if(windowWidth<481){jQuery('.mobile_popup').animate({top:0},500);}});}